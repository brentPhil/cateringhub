# Supabase Email Template - Invite User

This is your **exact current email design** converted to Supabase template format.

**âœ… VERIFIED** - All syntax confirmed from official Supabase documentation.

---

## ğŸ“§ **Template Configuration**

**Go to:** https://supabase.com/dashboard/project/ghfnyprmnluutpcacdjp/auth/templates

**Select:** "Invite User" template

---

## ğŸ“ **Subject Line**

Paste this into the "Subject" field:

```
Welcome to {{ .Data.provider_name }} - Set up your password
```

---

## ğŸ¨ **HTML Template**

Copy and paste this into the "Invite User" template in Supabase Dashboard:

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to {{ .Data.provider_name }}</title>
  </head>
  <body style="font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px;">
    <div style="background-color: #f8f9fa; border-radius: 8px; padding: 30px; margin-bottom: 20px;">
      <h1 style="color: #2563eb; margin-top: 0;">Welcome to {{ .Data.provider_name }}!</h1>

      <p style="font-size: 16px; margin-bottom: 20px;">
        Hi {{ .Data.full_name }},
      </p>

      <p style="font-size: 16px; margin-bottom: 20px;">
        {{ .Data.admin_name }} has created an account for you on <strong>{{ .Data.provider_name }}</strong> as a <strong>{{ .Data.role }}</strong>.
      </p>

      <div style="background-color: #fff; border-left: 4px solid #2563eb; padding: 15px; margin: 20px 0;">
        <p style="margin: 0; font-size: 14px; color: #666;">
          <strong>Your role:</strong> {{ .Data.role }}
        </p>
      </div>

      <p style="font-size: 16px; margin-bottom: 20px;">
        To get started, you'll need to set up your password. Click the button below to create your password and access your account:
      </p>

      <div style="text-align: center; margin: 30px 0;">
        <a href="{{ .ConfirmationURL }}"
           style="background-color: #2563eb; color: white; padding: 14px 28px; text-decoration: none; border-radius: 6px; font-weight: 600; display: inline-block;">
          Set up your password
        </a>
      </div>

      <p style="font-size: 14px; color: #666; margin-top: 30px;">
        <strong>Important:</strong> This link will expire in 24 hours for security reasons. If you don't set up your password within this time, please contact {{ .Data.admin_name }} to resend the link.
      </p>

      <p style="font-size: 14px; color: #666; margin-top: 20px;">
        If the button doesn't work, copy and paste this link into your browser:
      </p>
      <p style="font-size: 12px; color: #666; word-break: break-all; background-color: #f1f1f1; padding: 10px; border-radius: 4px;">
        {{ .ConfirmationURL }}
      </p>
    </div>

    <div style="text-align: center; color: #999; font-size: 12px; margin-top: 30px;">
      <p>This account was created by {{ .Data.admin_name }} from CateringHub.</p>
      <p>If you believe this was sent in error, please contact {{ .Data.admin_name }}.</p>
    </div>
  </body>
</html>
```

---

## ğŸ“„ **Plain Text Template** (Optional)

If you want to also customize the plain text version:

```
Welcome to {{ .Data.provider_name }}!

Hi {{ .Data.full_name }},

{{ .Data.admin_name }} has created an account for you on {{ .Data.provider_name }} as a {{ .Data.role }}.

Your role: {{ .Data.role }}

To get started, you'll need to set up your password. Click the link below to create your password and access your account:

{{ .ConfirmationURL }}

IMPORTANT: This link will expire in 24 hours for security reasons. If you don't set up your password within this time, please contact {{ .Data.admin_name }} to resend the link.

---
This account was created by {{ .Data.admin_name }} from CateringHub.
If you believe this was sent in error, please contact {{ .Data.admin_name }}.
```

---

## âœ… **Verified Template Syntax**

Based on official Supabase documentation, the following has been confirmed:

### **Built-in Variables (Always Available)**
- `{{ .ConfirmationURL }}` - The invitation link (auto-generated by Supabase)
- `{{ .Token }}` - 6-digit OTP (alternative to ConfirmationURL)
- `{{ .TokenHash }}` - Hashed version of Token
- `{{ .SiteURL }}` - Your application's Site URL
- `{{ .RedirectTo }}` - Redirect URL passed to inviteUserByEmail
- `{{ .Email }}` - User's email address

### **Custom Metadata Variables (From `data` parameter)**
When you call `inviteUserByEmail(email, { data: { ... } })`, the data is:
1. âœ… Stored in `auth.users.raw_user_meta_data`
2. âœ… Accessible in email templates via `{{ .Data.field_name }}`
3. âœ… Case-sensitive (use exact field names)

**Example:**
```typescript
await supabase.auth.admin.inviteUserByEmail(email, {
  data: {
    full_name: "John Doe",
    role: "admin",
    provider_name: "Acme Corp"
  }
})
```

**In template:**
- `{{ .Data.full_name }}` â†’ "John Doe"
- `{{ .Data.role }}` â†’ "admin"
- `{{ .Data.provider_name }}` â†’ "Acme Corp"

---

## ğŸ”„ **Variable Mapping**

Here's how your current variables map to Supabase template variables:

| Your Current Variable | Supabase Template Variable | Source |
|----------------------|---------------------------|--------|
| `${fullName}` | `{{ .Data.full_name }}` | Custom metadata |
| `${providerName}` | `{{ .Data.provider_name }}` | Custom metadata |
| `${role}` | `{{ .Data.role }}` | Custom metadata |
| `${adminName}` | `{{ .Data.admin_name }}` | Custom metadata |
| `${passwordSetupLink}` | `{{ .ConfirmationURL }}` | Built-in |
| `${email}` | `{{ .Email }}` | Built-in |

---

## ğŸ“‹ **What Changed**

1. âœ… **Removed localhost detection** - Supabase handles this automatically
2. âœ… **Replaced variables** with Supabase template syntax (`{{ .Data.* }}`)
3. âœ… **Kept exact same design** - colors, spacing, layout all identical
4. âœ… **Kept exact same copy** - all text is the same

---

## âœ… **Next Steps**

1. **Copy the HTML template** above
2. **Go to Supabase Dashboard** â†’ Auth â†’ Email Templates â†’ "Invite User"
3. **Paste the HTML** into the template editor
4. **Update the subject line** to: `Welcome to {{ .Data.provider_name }} - Set up your password`
5. **Save changes**
6. **Test** by creating a new team member

---

## ğŸ“§ **Email Delivery**

Since you have **Custom SMTP enabled** with Resend:
- âœ… Emails will be sent via **smtp.resend.com** (your current setup)
- âœ… From: **team@cateringhubph.com** (your configured sender)
- âœ… Sender name: **catering hub** (your configured name)
- âœ… All Resend analytics and tracking will work

**Nothing changes in terms of email delivery** - just the template system!

---

## ğŸ¯ **Benefits**

1. âœ… **Same email design** - users won't notice any difference
2. âœ… **Same email delivery** - still using Resend SMTP
3. âœ… **Simpler code** - no manual link generation or email sending
4. âœ… **Better security** - Supabase handles link management
5. âœ… **Easier maintenance** - less custom code to debug

---

## ğŸ§ª **Testing Checklist**

After configuring the template:

- [ ] Create a test team member
- [ ] Verify email is received (check spam folder too)
- [ ] Verify email looks identical to current design
- [ ] Verify "Set up your password" button works
- [ ] Verify link redirects to `/auth/callback`
- [ ] Verify password setup flow works
- [ ] Test resend functionality
- [ ] Verify Resend analytics show the email

---

## âš ï¸ **Important Notes**

1. **Template variables are case-sensitive** - use exact syntax: `{{ .Data.full_name }}`
2. **ConfirmationURL is auto-generated** by Supabase - don't modify it
3. **Localhost detection removed** - Supabase handles environment detection
4. **Subject line supports variables** - you can use `{{ .Data.* }}` in subject too

---

## ğŸ” **Troubleshooting**

**If emails don't arrive:**
1. Check Supabase logs: Dashboard â†’ Logs â†’ Auth Logs
2. Check Resend dashboard for delivery status
3. Verify SMTP settings are still correct
4. Check spam folder

**If template variables don't work:**
1. Make sure you're using `{{ .Data.variable_name }}` syntax (with dots)
2. Check for typos in variable names
3. Verify you're passing the data in `inviteTeamMember()` call

---

## ğŸ“š **Resources**

- [Supabase Email Templates Docs](https://supabase.com/docs/guides/auth/auth-email-templates)
- [Your Supabase Dashboard](https://supabase.com/dashboard/project/ghfnyprmnluutpcacdjp)
- [Resend Dashboard](https://resend.com/emails)

